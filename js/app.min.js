"use strict";function email_test(e){return!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(e.value)}function testWebP(e){var t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}testWebP((function(e){!0===e?document.querySelector("html").classList.add("_webp"):document.querySelector("html").classList.add("_no-webp")}));const iconMenu=document.querySelector(".menu__icon"),menuBody=document.querySelector(".menu__body"),logo=document.querySelector(".header__logo"),menuLinks=document.querySelectorAll(".menu__link[data-goto]"),headerHeight=document.querySelector("header").offsetHeight,documentHeight=document.documentElement.clientHeight;if(iconMenu&&iconMenu.addEventListener("click",(function(e){iconMenu.classList.toggle("_active"),menuBody.classList.toggle("_active"),logo.classList.toggle("_active")})),menuLinks.length>0){function onMenuLinkClick(e){const t=e.target;if(t.dataset.goto&&document.querySelector(t.dataset.goto)){const n=document.querySelector(t.dataset.goto).getBoundingClientRect().top+pageYOffset-document.querySelector("header").offsetHeight;iconMenu.classList.contains("_active")&&(iconMenu.classList.remove("_active"),menuBody.classList.remove("_active"),logo.classList.remove("_active")),window.scrollTo({top:n,behavior:"smooth"}),e.preventDefault()}}menuLinks.forEach(e=>{e.addEventListener("click",onMenuLinkClick)})}function menuOnScroll(){for(let t=0;t<menuLinks.length;t++){const n=menuLinks[t];if(n.dataset.goto&&document.querySelector(n.dataset.goto)){const t=document.querySelector(n.dataset.goto),o=t.offsetHeight,s=e(t).top;function e(e){const t=e.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,o=window.pageYOffset||document.documentElement.scrollTop;return{top:t.top+o,left:t.left+n}}pageYOffset>s-documentHeight&&pageYOffset<s+o-headerHeight?n.classList.add("_active"):n.classList.remove("_active")}}}window.addEventListener("scroll",menuOnScroll);const animItems=document.querySelectorAll("._anim-items"),header=document.querySelector(".header");if(animItems.length>0){function animOnScroll(){for(let e=0;e<animItems.length;e++){const t=animItems[e],n=t.offsetHeight,o=header.offsetHeight,s=offset(t).top,c=4;let i=document.documentElement.clientHeight-n/c;n>document.documentElement.clientHeight&&(i=document.documentElement.clientHeight-document.documentElement.clientHeight/c),pageYOffset>s-i&&pageYOffset<s+n-o?t.classList.add("_anim"):t.classList.contains("_anim-no-hide")||t.classList.remove("_anim")}}function offset(e){const t=e.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,o=window.pageYOffset||document.documentElement.scrollTop;return{top:t.top+o,left:t.left+n}}window.addEventListener("scroll",animOnScroll),setTimeout(()=>{animOnScroll()},300)}const form=document.getElementById("form");if(form){const e=document.querySelector(".form__sended-body"),t=document.querySelector(".form__sended-btn"),n=document.querySelector(".button-up"),o=document.getElementById("formMessage"),s=document.querySelector(".form__count"),c=document.querySelector(".popup-message"),i=document.querySelectorAll(".popup-close"),l=document.querySelectorAll(".text-container");for(const e of l)e.addEventListener("click",inputClick);function inputClick(e){let t=e.target;if("INPUT"==t.tagName||"TEXTAREA"==t.tagName){let e=this.getElementsByTagName("label")[0];e&&(e.classList.add("change"),t.addEventListener("blur",()=>{""==t.value&&e.classList.remove("change")}))}}async function formSend(t){t.preventDefault();let o=formValidate(form),s=new FormData(form);if(0===o){let t=await fetch("sendmail.php",{method:"POST",body:s});if(t.ok){let o=await t.json();"ok"==o.status?(form.classList.add("sended"),e.classList.add("sended"),n.classList.add("sended"),formReset(form)):showSending(`${o.message} Причина ошибки: ${o.status}`)}else showSending("Ошибка при отправке сообщения. Статус ошибки: "+t.status)}}function formValidate(e){let t=0,n=document.querySelectorAll("._req");for(let e=0;e<n.length;e++){const o=n[e];o.classList.remove("_error"),o.classList.contains("form__email")?email_test(o)&&(addErrorMessage(o,"Пожалуйста, введите корректный email адрес"),o.classList.add("_error"),t++):""===o.value&&(addErrorMessage(o,"Пожалуйста, заполните обязательное поле"),o.classList.add("_error"),t++)}return t}function addErrorMessage(e,t){let n=document.createElement("div");n.className="form__message-error",n.innerHTML=t,n.style.width="100%",e.after(n),n.style.top=e.offsetHeight+"px",n.style.left=0,e.addEventListener("input",()=>{n.remove()})}function formReset(e){e.reset(),document.querySelector(".form__count").textContent="0";let t=e.querySelectorAll(".change");for(const e of t)e.classList.remove("change")}function showSending(e){c.classList.add("open"),document.querySelector(".str-popup").textContent=e}o.addEventListener("input",e=>{s.textContent=e.target.value.length}),form.addEventListener("submit",formSend),t.addEventListener("click",()=>{form.classList.remove("sended"),e.classList.remove("sended"),n.classList.remove("sended")}),c.addEventListener("click",(function(e){e.target.closest(".popup__content")||c.classList.remove("open")})),document.addEventListener("keydown",(function(e){27===e.which&&c.classList.remove("open")}));for(const e of i)e.addEventListener("click",()=>{c.classList.remove("open")})}