function email_test(e){return!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(e.value)}function testWebP(e){var t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}testWebP((function(e){!0===e?document.querySelector("html").classList.add("_webp"):document.querySelector("html").classList.add("_no-webp")}));const iconMenu=document.querySelector(".menu__icon"),menuBody=document.querySelector(".menu__body"),logo=document.querySelector(".header__logo"),menuLinks=document.querySelectorAll(".menu__link[data-goto]"),headerHeight=document.querySelector("header").offsetHeight,documentHeight=document.documentElement.clientHeight;if(iconMenu&&iconMenu.addEventListener("click",(function(e){iconMenu.classList.toggle("_active"),menuBody.classList.toggle("_active"),logo.classList.toggle("_active")})),menuLinks.length>0){function onMenuLinkClick(e){const t=e.target;if(t.dataset.goto&&document.querySelector(t.dataset.goto)){const o=document.querySelector(t.dataset.goto).getBoundingClientRect().top+pageYOffset-document.querySelector("header").offsetHeight;iconMenu.classList.contains("_active")&&(iconMenu.classList.remove("_active"),menuBody.classList.remove("_active"),logo.classList.remove("_active")),window.scrollTo({top:o,behavior:"smooth"}),e.preventDefault()}}menuLinks.forEach(e=>{e.addEventListener("click",onMenuLinkClick)})}function menuOnScroll(){for(let t=0;t<menuLinks.length;t++){const o=menuLinks[t];if(o.dataset.goto&&document.querySelector(o.dataset.goto)){const t=document.querySelector(o.dataset.goto),n=t.offsetHeight,s=e(t).top;function e(e){const t=e.getBoundingClientRect(),o=window.pageXOffset||document.documentElement.scrollLeft,n=window.pageYOffset||document.documentElement.scrollTop;return{top:t.top+n,left:t.left+o}}pageYOffset>s-documentHeight&&pageYOffset<s+n-headerHeight?o.classList.add("_active"):o.classList.remove("_active")}}}window.addEventListener("scroll",menuOnScroll);const animItems=document.querySelectorAll("._anim-items"),header=document.querySelector(".header");if(animItems.length>0){function animOnScroll(){for(let e=0;e<animItems.length;e++){const t=animItems[e],o=t.offsetHeight,n=header.offsetHeight,s=offset(t).top,c=4;let l=document.documentElement.clientHeight-o/c;o>document.documentElement.clientHeight&&(l=document.documentElement.clientHeight-document.documentElement.clientHeight/c),pageYOffset>s-l&&pageYOffset<s+o-n?t.classList.add("_anim"):t.classList.contains("_anim-no-hide")||t.classList.remove("_anim")}}function offset(e){const t=e.getBoundingClientRect(),o=window.pageXOffset||document.documentElement.scrollLeft,n=window.pageYOffset||document.documentElement.scrollTop;return{top:t.top+n,left:t.left+o}}window.addEventListener("scroll",animOnScroll),setTimeout(()=>{animOnScroll()},300)}let form=document.getElementById("form");if(form){let e=document.querySelector(".form__sended-body"),t=document.querySelector(".form__sended-btn"),o=document.querySelector(".button-up"),n=document.getElementById("formMessage"),s=document.querySelector(".popup-message"),c=document.querySelectorAll(".popup-close");function countMessage(e){let t=e.target.value.length;document.querySelector(".form__count").textContent=t}function addErrorMessage(e,t){let o=document.createElement("div");o.className="form__message-error",o.innerHTML=t,o.style.width="100%",e.after(o),o.style.top=e.offsetHeight+"px",o.style.left=0,e.addEventListener("input",()=>{o.remove()})}function formValidate(e){let t=0,o=document.querySelectorAll("._req");for(let e=0;e<o.length;e++){const n=o[e];n.classList.remove("_error"),n.classList.contains("form__email")?email_test(n)&&(addErrorMessage(n,"Пожалуйста, введите корректный email адрес"),n.classList.add("_error"),t++):""===n.value&&(addErrorMessage(n,"Пожалуйста, заполните обязательное поле"),n.classList.add("_error"),t++)}return t}async function formSend(t){t.preventDefault();let n=formValidate(form),s=new FormData(form);if(0===n){let t=await fetch("sendmail.php",{method:"POST",body:s});if(t.ok){let n=await t.json();"ok"==n.status?(form.classList.add("sended"),e.classList.add("sended"),o.classList.add("sended"),formReset(form)):showSending(`${n.message} Причина ошибки: ${n.status}`)}else showSending("Ошибка при отправке сообщения. Статус ошибки: "+t.status)}}function formReset(e){e.reset(),document.querySelector(".form__count").textContent="0";let t=document.querySelectorAll(".change");for(const e of t)e.classList.remove("change")}function showSending(e){s.classList.add("open"),document.querySelector(".str-popup").textContent=e}form.addEventListener("click",e=>{let t=e.target.closest(".text-container"),o=e.target.tagName;if(t&&("INPUT"==o||"TEXTAREA"==o)){let o=e.target,n=t.getElementsByTagName("label")[0];n.classList.add("change"),o.addEventListener("blur",()=>{""==o.value&&n.classList.remove("change")})}}),n.addEventListener("input",countMessage),form.addEventListener("submit",formSend),t.addEventListener("click",()=>{form.classList.remove("sended"),e.classList.remove("sended"),o.classList.remove("sended")}),s.addEventListener("click",(function(e){e.target.closest(".popup__content")||s.classList.remove("open")})),document.addEventListener("keydown",(function(e){27===e.which&&s.classList.remove("open")}));for(const e of c)e.addEventListener("click",()=>{s.classList.remove("open")})}